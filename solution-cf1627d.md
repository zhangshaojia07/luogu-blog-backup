# CF1627D Not Adding

### Preface

考场上没想出来，我是↑↓。

### Analysis

**先将 $\{a\}$ 按值入桶（正好去重）。**

记 $V=\max\{a\}$ 表示值域。

由于值域只有 $10^6$，我们可以从 $1$ 到 $V$ 检查每一个数是否能表示为 $\{a\}$ 中某些数的 $\gcd$。

考虑类似埃氏筛的算法：记 $\{a\}$ 中 $x$ 的倍数有 $f(x)$ 个，这个 $f$ 我们能在 $O(V\log V)$ 内求出。

如果一个数 $x$ 不能表示成 $\{a\}$ 中某些数的 $\gcd$，则 $\{a\}$ 中 $x$ 的倍数均是 $bx$ 的倍数，其中 $b\in\{2,3,4,\dots\}$ 为常数。

所以我们类似上面的做法遍历 $x$ 的倍数 $y$（不包括 $x$）判断 $[f(x)=f(y)]$ 是否成立。

时间 $O(n+V\log V)$。

### Detail

最后个数记得减去本来存在的那些数。

### Code

[Link](https://codeforces.com/contest/1627/submission/143324559)