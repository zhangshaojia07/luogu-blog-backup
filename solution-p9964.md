# P9964 [THUPC 2024 初赛] 多折较差验证

一个 DP 是 $f_{l,r},g_{l,r}$ 表示区间 $[l,r]$ 折完的最少次数，及满足最少次数时的最小代价。

转移分别考虑折痕为 $l-1,r+1$ 位置的情况。

考虑先求出 $f$，按长度升序转移，两个方向的转移分别是长度前缀的 $f$ 进行 check min，而且由于 $f$ 在两维均单调，所以用横竖各 $n$ 个队列维护即可。

求完 $f$ 后对于 $g$ 可以仿照上述过程，但由于 $g$ 的转移不能发生在 $f$ 值相同的状态之间，所以做法稍有不同：在一个状态向右侧（左侧同理）增长 $1$ 后若 $f$ 不同了，则将等于其 $f$ 值、左端点相同的状态的 $g$ 同时转移，这样也不用队列了（允许离线了），做前缀 $\min$ 即可。

复杂度 $O(n^2)$。

赛时写挂硬是没调出来。

没用到反回文串个数的性质，跪求大佬教教反回文串个数上界证明。