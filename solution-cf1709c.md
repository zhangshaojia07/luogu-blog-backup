# CF1709C Recover an RBS（括号序列性质）

我们先算出来问号的地方要放几个左括号，设为 $cnt$，问号总个数设为 $q$。

若 $cnt=q$ 或 $0$ 必然唯一。

**将 $cnt$ 个左括号放 $q$ 个问号的前 $cnt$ 个位置必然是合法的括号序列**。

↑ 设这种方案为 $A$。

我们换一种填法：把“前 $cnt$ 个”换成“前 $cnt-1$ 个和第 $cnt+1$ 个”（也就是将第 $cnt$ 个和第 $cnt+1$ 个互换）。

↑ 设这种方案为 $B$。

若 $B$ 可行，则答案为 NO。

否则，我们证明答案一定为 YES。

我们将左括号看作 $1$，右括号看作 $-1$。

因为 $B$ 不可行，所以存在一个位置 $x$，使得前缀和 $<0$。

由于除了 $A$ 以外没有其他方案的 $x$ 位置前缀和 $> B$ 方案（$B$ 已经尽量将左括号放在前面了），$x$ 位置的前缀和在所有非 $A$ 方案中均 $<0$，原命题得证。

代码太丑了，不放了。