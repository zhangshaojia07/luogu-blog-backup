# CF1775F Laboratory on Pluto（根号/分拆数）

首先，我们基地必然是一个四联通块，否则咋样合并一下周长总会减小。

其次，基地不凹——将周长投影在两维，不可能存在两层以上的重叠。

这样的话，基地的周长就是其外边框的周长。

枚举外边框矩形的一边长度 $a$，就可以得到 $u=1$ 的答案。

$u=2$，对于每一个 $a$，我们可以确定最小的另一边长 $b$。规定 $a\le b$，$a=b$ 时答案要 $\times 2$。

我们考察外边框减基地的那些空位，个数必然 $<a$，所以怎么排都不会减小外边框。

空位放在一个角上的方案数就是无序分拆数（这个暴力求即可），我们将其（OGF）四次方就是总方案数。

预处理复杂度 $O(\max n)$，单次询问复杂度 $O(n^{1/4})$。

为什么是 $n^{1/4}$ 呢？因为合法的外边框数只有 $O(n^{1/4})$，考虑从接近正方形的外边框不断缩小一边的长度，缩小一个单位另一边必然增加至少一个单位，若增加至少两个单位则接下来都不是答案了，然而边框内空位个数会以平方级别减少，所以最多 $\sqrt{\sqrt n}$ 次就会不止一个单位地增加。

当然写单次 $O(\sqrt n)$ 最方便。