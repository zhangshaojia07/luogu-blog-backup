# CF1660D Maximum Product Strikes Back

### Analysis

其实题意就是**选一个子串使得乘积最大**。

设 $b_i=[a_i<0]$。首先，**答案至少为** $1$，因为可以是空串。所以接下来我们只需要考察**区间内 $b_i=\text{True}$ 的个数为偶数**的子串。

将原序列按照 $a_i=0$ 的位置分段，在每段求答案后取最大值即可。

发现每个数**只有两种因子** $-1$ 和 $2$。

设当前段为 $[l,r]$，其中 $b_i=\text{True}$ 的个数为 $cnt$。

若 $2\ |\ cnt$，则直接选取整段 $[l,r]$ 作为答案即为乘积最大。

否则，设第一个和最后一个 $b_i=\text{True}$ 的位置分别为 $x,y$，则此段答案为 $[l,y-1]$ 和 $[x+1,r]$ 答案中的较大值。

时间 $O(n)$

### Code

[Link（代码较丑，见谅）](https://codeforces.com/contest/1660/submission/152282315)