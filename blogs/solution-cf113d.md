# CF113D Museum（概率/高斯消元）

两个人位置状态共 $n^2$ 种，一个时刻后每种状态概率转移可以用 $n^2\times n^2$ 的矩阵 $A$ 表示，设上一个时刻 $n^2$ 种状态分别的概率为列向量 $v$，时刻后为 $v'$，则
$$
Av=v'
$$
设答案向量为 $t$，初始向量为 $v_0$，则可以有
$$
t=A^{\infty}v_0
$$
但是这样不好算，由于到终态时不会再跑出去，所以可以改写成
$$
t=\sum_{i=0}^{\infty}A^iv_0
$$
注意两个式子的 $t$ 不相等。

无穷求和经典套路
$$
\begin{aligned}
t&=\sum_{i=0}^{\infty}A^iv_0
\\&=v_0+\sum_{i=1}^{\infty}A^iv_0
\\&=v_0+A\sum_{i=0}^{\infty}A^iv_0
\\&=v_0+At
\end{aligned}
$$
即
$$
(A-I)t=-v_0
$$
高斯消元，启动！$O(n^6)$。