# CF1616D Keep the Average High

首先设 $b_i=a_i-x$，这样原问题就转化为：给 $\{b\}$ 中 $c$ 个元素染色，使得 $\{b\}$ 中 任意 全染色 且 长度 $>1$ 的子串 中 元素值 之和 $\ge0$，求 $c$ 的最大值。

由于这些子串的定义太长，设全染色且长度 $>1$ 为 A 条件，全染色且长度 $=2$ 或 $3$ 为 B 条件。

**结论：$\{b\}$ 中任意满足 A 条件的子串元素值之和 $\ge0\iff\{b\}$ 中任意满足 B 条件的子串元素值之和 $\ge0$**

**证明：**

正推显然。

逆推。对于 $\{b\}$ 的任意满足 A 条件的子串，由裴蜀定理，总可以划分成多个满足 B 条件的子串，而满足 B 条件的子串元素值的和 $\ge0$，所以整个子串值之和 $\ge0$。

**证毕。**

由此，我们可以用简单的线性 Dp 实现 $O(n)$ 做法。$f(i,j,k)$ 表示当前遍历过到 $\{b\}$ 的前 $i$ 位，第 $i-1$ 位是（$j=1$）否（$j=0$）染色，第 $i$ 位是（$k=1$）否（$k=0$）染色，前 $i$ 位染色数目的最大值。

转移方程请自行思考（简单）。