# CF1707C DFS Trees（DFS 搜索树）

**用并查集求出 MST。**

由于题目给的边权两两不同，所以：

**MST 唯一。**

然后观察函数的遍历顺序，发现：

**题目给的函数生成的是从每个点出发的 DFS 搜索树。**

然后就是关键的想法：

**DFS 搜索树没有横向边。**

然而除了横向边就是返祖边，有：

**所有返祖边均可行。**

设 $v$ 向 $u$ 返祖，$u$ 向 $v$ 的第一条边连向 $w$，由于 MST 的性质，得到边权的不等式 $(u,v)>(u,w)$，所以在 $u$ 点要遍历 $v$ 的时候 $v$ 点必然已经被访问过了，所以返祖边可行。

由于横向边不可行，得到本题的充要条件：

**对于每一条非树边 $(u,v)$，树上一个点 $x$ 能作为起始点当且仅当 $x$ 第一次走到 $\text{path}(u,v)$ 时是在 $u$ 或 $v$。**

由于和子树有关，我们想到统计方式：

**树上差分。**

然后就做完了，实现可做到：

**时间复杂度线性。**

[代码](https://codeforces.com/contest/1707/submission/164574252)

