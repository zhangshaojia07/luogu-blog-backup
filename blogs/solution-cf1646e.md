# CF1646E Power Board

### Preface

「这不是简单的数论题吗？」

「是啊。」

「那为啥这有一个↑↓明明会正解却没写出来……」

### Analysis

第一行单独算，直接判掉不再考虑。

设每行首个为**代表元**。由于 $2^{20}>10^6$，也就是说任意两个代表元 $x,y$ 有 $\log_xy<20$

设 $f(x)$ 为最小的正整数 $y$ 使得 $\log_y x\in\mathbb{N}$。我们称一些代表元为**一族**（元素周期表乱入），当且仅当她们的 $f$ 相同。显然单个族的大小不超过 $20$。

发现**不同族之间不可能有数相同**，我们将每个组分开考虑。

发现**只要族的大小相等，所含不同元素个数必然相同**，我们预处理出不同大小族对答案的贡献即可。

时间 $O(20m)$ 预处理 和 $O(n)$ 计算。

### Code

[Link](https://codeforces.com/contest/1646/submission/149199155)