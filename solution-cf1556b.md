# CF1556B题解

### 题意简述

求使一个序列奇偶交错的相邻数交换操作最小次数。

### 题目分析

其实很简单。

先数奇偶数的个数，**特判掉无解的情况**。

若有解，则最终的状态一定是以下其中一个：

1. 第一个数为奇数，剩下的数奇偶交错排列。~~两岸石壁，五色交辉。~~

2. 第一个数为偶数，剩下的数奇偶交错排列。

其中设奇数个数为 $cnt$，偶数个数为 $(n-cnt)$：

若 $cnt>n-cnt$ 则只有情况 1 满足。

若 $cnt<n-cnt$ 则只有情况 2 满足。

若 $cnt=n-cnt$ 则情况 1，2 皆可，其中取最小操作次数即可。

那怎么求**固定首位奇偶**的最小操作次数呢？

首先给出一个显然的定理（好好读读）：

**两个同奇偶的数在最终状态下在序列中的位置前后关系不变的情况的答案不比其他方案更劣。**

也就是说我们**不改变奇数和偶数内部的顺序**就能得到最优方案。 

而且固定首位奇偶性的情况下，最终序列是唯一（有且仅有一个）的。

于是我就得到了一个特别神奇的想法：

1. 给每一个序列里的位置，写上这个位置上的数在最终状态下的位置。

2. 交换相邻两数的过程**相当于冒泡排序这个位置序列**，即最终答案为冒泡排序交换次数。

3. 冒泡排序交换次数又等于**序列逆序对对数**，所以 $O(n\log n)$ 用归并排序求即可。

总体复杂度 $O(Tkn\log n)$，其中 $k$ 为极小的常数。

[show me the code.](https://codeforces.com/contest/1556/submission/128043114)